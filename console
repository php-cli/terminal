#!/usr/bin/env php
<?php

declare(strict_types=1);

require __DIR__ . '/vendor/autoload.php';

use Butschster\Commander\ExceptionRenderer;
use Butschster\Commander\Module\CommandBrowser\CommandBrowserModule;
use Butschster\Commander\Module\ComposerManager\ComposerModule;
use Butschster\Commander\Module\FileBrowser\FileBrowserModule;
use Butschster\Commander\SDK\Builder\ApplicationBuilder;
use Butschster\Commander\UI\Theme\MidnightTheme;
use Symfony\Component\Console\Application as SymfonyApplication;

// Create Symfony Console Application
$symfonyApp = new SymfonyApplication('My Console Application', '1.0.0');

// Add more commands here as needed
// $symfonyApp->add(new AnotherCommand());

try {
    $app = ApplicationBuilder::create()
        // Register modules
        ->withModule(new CommandBrowserModule($symfonyApp))
        ->withModule(new FileBrowserModule((string) getcwd()))
        ->withModule(new ComposerModule(__DIR__))

        // Configuration
        ->withTheme(new MidnightTheme())
        ->withFps(30)

        // Start with command browser
        ->withInitialScreen('command_browser')

        ->build();

    $app->run();
} catch (\Throwable $e) {
    echo (new ExceptionRenderer())->render($e, true);

    exit(1);
}
